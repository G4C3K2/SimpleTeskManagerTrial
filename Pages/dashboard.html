<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Strona główna</title>
<link rel="stylesheet" href="stylehome.css">
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <h1 class="block-effect" style="--td: 1.2s">
                <div class="block-reveal" style="--bc: #3A3A3A; --d: .1s">Task</div>
                <div class="block-reveal" style="--bc: #F06543; --d: .5s">Planner</div>
            </h1>
        </div>
        <button class="create-btn">Utwórz</button>
        <ul class="menu">
            <li>Strona główna</li>
            <li>Moje zadania</li>
            <li>Cele</li>
        </ul>
    </div>

    <div class="main-content">
        <header>
            <div class="user">
                <h2>Dzień dobry, User</h2>
            </div>
            <div class="wyloguj">
                <button class="logout" id="logout-btn">Wyloguj</button>
            </div>
        </header>
        <div class="tasks-projects">
            <div class="tasks">
                <h3>Moje zadania</h3>
                <ul>
                    <li>Zadanie 1</li>
                    <li>Zadanie 2</li>
                    <li>Zadanie 3</li>
                    <li>Zadanie 4</li>
                    <li>Zadanie 5</li>
                    <li>Zadanie 6</li>
                </ul>
            </div>
            <div class="projects">
                <h3>Projekty</h3>
                <div class="group-list" id="main-group-list">
                    <div class="add-group" id="main-add-group-btn">+</div>
                </div>
            </div>
        </div>
        <div class="team">
            <h3>Osoby</h3>
            <ul>
                <li>Osoba 1</li>
                <li>Osoba 2</li>
                <li>Osoba 3</li>
            </ul>
        </div>
    </div>

    <script>
        const mainGroupList = document.getElementById('main-group-list');
        const mainAddGroupBtn = document.getElementById('main-add-group-btn');

        // Symulacja istniejących grup
        let userMainGroups = ['Projekt 1', 'Projekt 2'];

        // Funkcja renderująca grupy
        function renderMainGroups() {
            mainGroupList.innerHTML = '';
            userMainGroups.forEach(groupName => {
                const groupItem = document.createElement('div');
                groupItem.className = 'group-item';
                groupItem.textContent = groupName;
                mainGroupList.appendChild(groupItem);
            });

            // Dodaj przycisk "dodaj grupę" na końcu listy
            mainGroupList.appendChild(mainAddGroupBtn);
        }

        // Obsługa kliknięcia na przycisk dodawania grupy
        mainAddGroupBtn.addEventListener('click', () => {
            const groupName = prompt('Podaj nazwę nowej grupy:');
            if (groupName) {
                userMainGroups.push(groupName);
                renderMainGroups();
            }
        });

        // Renderowanie grup przy załadowaniu strony
        renderMainGroups();

        // Wylogowanie
        document.getElementById('logout-btn').addEventListener('click', () => {
            fetch('http://localhost:5005/task-manager/auth/logout', {
                method: 'GET',
            })
            .then(response => {
                if (response.ok) {
                    alert('Wylogowano pomyślnie');
                    window.location.href = '/login';
                } else {
                    alert('Błąd podczas wylogowywania');
                }
            })
            .catch(error => {
                console.error('Błąd:', error);
                alert('Nie udało się połączyć z serwerem');
            });
        });
    </script>
</body>
</html>